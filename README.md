# Guess The Number
This is my first project written in Go & HTMX and I quite enjoyed it. \
It's a simple game where a hint is given to each guess until the user gets the correct answer. \
In a hint, ?a means there are ? numbers that are in the correct positions, 
while ?b means there are ? numbers that are in the final answer but are misplaced. \
For example, if guess = 312 and the answer is 321, the hint would be 1a2b.

<p align="center">
<img height="400" width="320" alt="Screenshot 2024-05-31 at 5 14 29 PM" src="https://github.com/livingpool/guess-the-number/assets/52132459/97dba180-16b1-4f25-b29c-48489c7b872f">
&nbsp;&nbsp;&nbsp;
<img height="400" width="350" alt="Screenshot 2024-05-31 at 5 13 26 PM" src="https://github.com/livingpool/guess-the-number/assets/52132459/704bee09-fcac-4242-8765-db64e18e7a59">
</p>

### To run this project locally
- I use [turso](https://turso.tech) as a serverless sql database.
- To start the project, first make a copy of .env.example and name it .env. \
  Make an account at turso and fill in the url and token in .env.

- Old school way (Go version 1.22+ is required):
```bash
cd cmd
go run .
```

- If you have [Air](https://github.com/cosmtrek/air) installed
```bash
 air -c ./air.toml
```

### Project structure
When a client hits the /new endpoint, a new player instance is created and added to the player pool. \
A player will automatically be removed from the pool after some time of inactivity(timeout).
```
  ├── cmd
        ├── main.go           
  ├── constants                  (constants, auto-incremented playerId)
  ├── handler
        ├── game.go              (main game logic and http handlers)
        ├── game_test.go         (unit tests using testify, mockery)
  ├── middleware
  ├── mocks                      (mocks auto-generated by mockery)
  ├── router                     (routing based on Go 1.22 routing enhancements)
  ├── service                    (database models and connection logics)
        ├── leaderboard.go       (db connection module for leaderboard)
        ├── leaderboard_test.go  (integration tests for leaderboard)
        ├── player.go            (definitions for Player)
        ├── playerPool.go        (definitions for PlayerPool)
  ├── utils
  ├── views
        ├── assets
        ├── css
        ├── html                 (go html templates)
        ├── scripts              (additional JS code for better visuals)
        ├── html.go              (code for rendering templates)           
```

### Deployment tech stack
- ci && cd: github actions
- server: google app engine
- database: turso

### TODOs
- api protection (will need some sort of state on the server)
- move static assets to google cloud storage (s3-compatible)
- see how to analyse structured logs (elastic search?)
- more comprehensive logging (inspired by [ slog-http ](https://github.com/samber/slog-http))
- replace mocking with unit + integration tests only
- pull out db layer from service layer (follows previous)
- some caching?
- css transitions when showing leaderboard
- fix github actions
